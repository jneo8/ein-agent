# This file configures Charmcraft.
# See https://juju.is/docs/sdk/charmcraft-config for guidance.

name: ein-agent-api

type: charm

base: ubuntu@24.04

# the platforms this charm should be built on and run on.
# you can check your architecture with `dpkg --print-architecture`
platforms:
  amd64:
  # arm64:
  # ppc64el:
  # s390x:

# (Required)
summary: API service for Ein Agent workflow orchestration

# (Required)
description: |
  A FastAPI service that accepts webhooks (including Prometheus Alertmanager notifications)
  and triggers AI-driven root cause analysis workflows via Temporal. Maps alerts
  to customizable investigation prompts with MCP tool integration.

config:
  options:
    alert-prompts:
      type: string
      default: ""
      description: |
        YAML string content containing alert-to-prompt mappings.
        This defines which AI prompts and MCP servers to use for each alert type.
        The configuration should be provided as a YAML-formatted string that can be
        dynamically configured. See alert-prompts-example.yaml for the expected format.

    temporal-host:
      type: string
      default: "localhost:7233"
      description: |
        Temporal server host and port (e.g., "temporal.default.svc.cluster.local:7233").
        This is where the receiver will connect to trigger workflows.

    temporal-namespace:
      type: string
      default: "default"
      description: |
        Temporal namespace to use for workflow execution.

    temporal-queue:
      type: string
      default: "ein-agent-queue"
      description: |
        Temporal task queue name where workflows will be submitted.
        This should match the queue name that the ein-agent-worker is listening on.

extensions:
  - fastapi-framework
